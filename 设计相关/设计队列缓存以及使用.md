## 设计队列缓存以及使用

### 需求场景
- 当多个订单需要审核通过或者拒绝的时候，操作比较麻烦
- 订单审核操作 批量操作功能

### 实现交付结果
- 订单列表多选后 点击按钮，提交到后台，提示已添加成功，稍后查看结果

### 存在问题
- 订单需要和上游交互，存在网络延迟，批量订单操作，适合使用队列来实现
- 队列会存在订单重复执行问题

### 实现过程
- 页面添加按钮 审核 拒绝 回调
- 订单表加入是否审核字段 0添加 1执行中 2执行已完成
- 队列数据格式 {"id":"1","status":"pass/return"}
- 消费队列考虑到会有多台机器消费 顾读取消费后需要加入锁 审核结果当有多条记录再队列中，同一时间执行不同操作（通过、拒绝）不合理.
- 执行完成后 需要更新是否审核为已完成 注意需要加上 乐观锁 （更新的状态 必须是初始化或者已完成 where(‘是否审核’, 'in', {"0", "2"})）

