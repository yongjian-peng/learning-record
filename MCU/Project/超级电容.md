

#### 达到状态后，状态表

|      | 12A  |  5S  |                         跳帽1 2-开机                         | 跳帽1 2-关机 |
| :--: | :--: | :--: | :----------------------------------------------------------: | :----------: |
|  1   |  √   |  √   |                        开机，保持不变                        | 不存在此状态 |
|  2   |  √   |  ×   |                         不存在此状态                         |    不操作    |
|  3   |  ×   |  ×   |                         不存在此状态                         | 保持当前不变 |
|  4   |  ×   |  √   | 非法掉电 1 4 ，发送1S 底电平信号，关机，如果是单插电容的话，则保持 | 不存在此状态 |



#### 功能梳理

```
需求
	当正常关机时候则关机 12A OK 5S 下降沿
	当非法断电时候则开机 12A NO 5S 下降沿 则触发 发出PWM 信号
使用的 
	OUT1 28 PB2  输出高电平 使用PWM
	5S 29 PB10 TIM2_CH3
	12A 30 PB11 TIM2_CH4
调试 串口能正常收发字符串。并能正确的打印到 com 口
外部中断检测电源 12V 和 5V 电源 是否有信号收到。
定期输出 PWM 波形 使用输出比较 

发现的问题
	电容的 电压 一串 4.0V 另外两串 3.0V 或者 2.8V 是不能长时间供电的 
	三串使用 电压范围 差值小的 电容，可以正常使用。
	
当关机动作时候，来电了，就不断电
当开机动作时候，断电了，就不开机了。
```

Z:\整机研发测试记录\非标\济南\宋金玲\烟台恒研智能科技有限公司\测试资料\指纹模块\安卓

#### 状态表

|      | 12A  |  5S  |      跳帽1 2-开机       |      跳帽1 2-关机       |
| :--: | :--: | :--: | :---------------------: | :---------------------: |
|  1   |  √   |  √   |        保持不变         |      不存在此状态       |
|  2   |  √   |  ×   |      不存在此状态       | 发送1S 底电平信号，开机 |
|  3   |  ×   |  ×   |      不存在此状态       |      保持当前不变       |
|  4   |  ×   |  √   | 发送1S 底电平信号，关机 |      不存在此状态       |





|      | 12A  |  5S  | 跳帽浮空-开机 |      跳帽浮空-关机      |
| :--: | :--: | :--: | :-----------: | :---------------------: |
|  1   |  √   |  √   |   保持不变    |      不存在此状态       |
|  2   |  √   |  ×   | 不存在此状态  | 发送1S 底电平信号，开机 |
|  3   |  ×   |  ×   | 不存在此状态  |        保持不变         |
|  4   |  ×   |  √   | 保持开机状态  |      不存在此状态       |

```
跳帽1 2 
非法掉电 1 4 3 
电容上电，给12A 4 1
正常  1 2 
有12V_A 去掉电阻 2 状态 反复开关机
无12V_A 去掉电阻 4 变 3 后 一直开机

跳帽浮空
正常 1 2 开机 
非法掉电 4 3 
串口板
	红色 TX 黑色 RX
```

02.07 吴晓来拿走一块超级电容，出货

#### 非法掉电

![image-20260206153343357](E:\Git\learning-record\MCU\Project\assets\image-20260206153343357.png)

插上电容，开启电容，开机后，然后关机 

else if (power_12A_flag == POWER12A_STATE_FALLING && power_5S_flag == POWER5S_STATE_RISING)

![image-20260206153718575](E:\Git\learning-record\MCU\Project\assets\image-20260206153718575.png)







#### 代码烧录工具

![image-20260128151512846](E:\Git\learning-record\MCU\Project\assets\image-20260128151512846.png)

![image-20260128151539250](E:\Git\learning-record\MCU\Project\assets\image-20260128151539250.png)



![image-20260128151600937](E:\Git\learning-record\MCU\Project\assets\image-20260128151600937.png)



![image-20260128151807851](E:\Git\learning-record\MCU\Project\assets\image-20260128151807851.png)

![image-20260128151855596](E:\Git\learning-record\MCU\Project\assets\image-20260128151855596.png)

![image-20260128151941139](E:\Git\learning-record\MCU\Project\assets\image-20260128151941139.png)

